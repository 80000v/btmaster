function SortableTable(a){this.sortTypes=[];this.sortColumn=null;this.descending=null;var b=this;this._headerOnclick=function(d){b.headerOnclick(d);};if(a){this.setTable(a);this.document=a.ownerDocument||a.document;}else{this.document=document;}var c=this.document.defaultView||this.document.parentWindow;this._onunload=function(){b.destroy();};if(c&&typeof c.attachEvent!="undefined"){c.attachEvent("onunload",this._onunload);}}SortableTable.gecko=navigator.product=="Gecko";SortableTable.msie=/msie/i.test(navigator.userAgent);SortableTable.removeBeforeSort=SortableTable.gecko;SortableTable.prototype.onsort=function(){};SortableTable.prototype.defaultDescending=true;SortableTable.prototype._sortTypeInfo={};SortableTable.prototype.setTable=function(a){if(this.tHead){this.uninitHeader();}this.element=a;this.setTHead(a.tHead);this.setTBody(a.tBodies[0]);};SortableTable.prototype.setTHead=function(a){if(this.tHead&&this.tHead!=a){this.uninitHeader();}this.tHead=a;this.initHeader();};SortableTable.prototype.setTBody=function(a){this.tBody=a;};SortableTable.prototype.setSortTypes=function(){if(this.tHead){this.uninitHeader();}if(this.tHead){this.initHeader();}};SortableTable.prototype.initHeader=function(){if(!this.tHead){return;}var b=this.tHead.rows[0].cells;var a=b.length;var e;for(var d=0;d<a;d++){var e=b[d];this.sortTypes[d]=e.axis;if(this.sortTypes[d]&&this.sortTypes[d]!="None"){if(this.sortTypes[d]!=null){e._sortType=this.sortTypes[d];}if(typeof e.addEventListener!="undefined"){e.addEventListener("click",this._headerOnclick,false);}else{if(typeof e.attachEvent!="undefined"){e.attachEvent("onclick",this._headerOnclick);}else{e.onclick=this._headerOnclick;}}e.className+=" tableHeaderOver";}else{this.sortTypes[d]="None";}}this.updateHeaderArrows();};SortableTable.prototype.uninitHeader=function(){if(!this.tHead){return;}var b=this.tHead.rows[0].cells;var a=b.length;var e;for(var d=0;d<a;d++){e=b[d];if(e._sortType!=null&&e._sortType!="None"){e.removeChild(e.lastChild);if(typeof e.removeEventListener!="undefined"){e.removeEventListener("click",this._headerOnclick,false);}else{if(typeof e.detachEvent!="undefined"){e.detachEvent("onclick",this._headerOnclick);}}e._sortType=null;e.removeAttribute("_sortType");}}};SortableTable.prototype.updateHeaderArrows=function(){if(!this.tHead){return;}var b=this.tHead.rows[0].cells;var a=b.length;var d=b[this.sortColumn];if(d==undefined){return;}if(d.className.contains("sortedASC"," ")){d.className=d.className.replace(new RegExp("(^|\\s)sortedASC(?:\\s|$)"),"$1").clean();d.className+=" sortedDESC";}else{if(d.className.contains("sortedDESC"," ")){d.className=d.className.replace(new RegExp("(^|\\s)sortedDESC(?:\\s|$)"),"$1").clean();d.className+=" sortedASC";}else{d.className+=" sortedDESC";}}for(var c=0;c<a;c++){if(b[c]._sortType!=null&&b[c]._sortType!="None"){if(c!=this.sortColumn){b[c].className=b[c].className.replace(new RegExp("(^|\\s)sortedASC(?:\\s|$)"),"$1").clean();b[c].className=b[c].className.replace(new RegExp("(^|\\s)sortedDESC(?:\\s|$)"),"$1").clean();}}}};SortableTable.prototype.headerOnclick=function(b){var a=b.target||b.srcElement;while(a.tagName!="TH"){a=a.parentNode;}this.sort(SortableTable.msie?SortableTable.getCellIndex(a):a.cellIndex);};SortableTable.getCellIndex=function(d){var b=d.parentNode.childNodes;var a=b.length;var c;for(c=0;b[c]!=d&&c<a;c++){}return c;};SortableTable.prototype.getSortType=function(a){return this.sortTypes[a]||"String";};SortableTable.prototype.sort=function(d,j,b){if(!this.tBody){return;}if(b==null){b=this.getSortType(d);}if(b=="None"){return;}if(j==null){if(this.sortColumn!=d){this.descending=this.defaultDescending;}else{this.descending=!this.descending;}}else{this.descending=j;}this.sortColumn=d;if(typeof this.onbeforesort=="function"){this.onbeforesort();}var k=this.getSortFunction(b,d);var m=this.getCache(b,d);var n=this.tBody;m.sort(k);if(this.descending){m.reverse();}if(SortableTable.removeBeforeSort){var g=n.nextSibling;var c=n.parentNode;c.removeChild(n);}var e=m.length;for(var h=0;h<e;h++){n.appendChild(m[h].element);if(h%2){m[h].element.className="alt2";}else{m[h].element.className="alt1";}}if(SortableTable.removeBeforeSort){c.insertBefore(n,g);}this.updateHeaderArrows();this.destroyCache(m);if(typeof this.onsort=="function"){this.onsort();}};SortableTable.prototype.asyncSort=function(c,a,d){var b=this;this._asyncsort=function(){b.sort(c,a,d);};window.setTimeout(this._asyncsort,1);};SortableTable.prototype.getCache=function(h,f){if(!this.tBody){return[];}var g=this.tBody.rows;var c=g.length;var b=new Array(c);var e;for(var d=0;d<c;d++){e=g[d];b[d]={value:this.getRowValue(e,h,f),element:e};}return b;};SortableTable.prototype.destroyCache=function(c){var a=c.length;for(var b=0;b<a;b++){c[b].value=null;c[b].element=null;c[b]=null;}};SortableTable.prototype.getRowValue=function(a,f,d){if(this._sortTypeInfo[f]&&this._sortTypeInfo[f].getRowValue){return this._sortTypeInfo[f].getRowValue(a,d);}var b;var e=a.cells[d];if(!e){return false;}if(typeof e.innerText!="undefined"){b=e.innerText;}else{b=SortableTable.getInnerText(e);}return this.getValueFromString(b,f);};SortableTable.getInnerText=function(e){var d="";var c=e.childNodes;var a=c.length;for(var b=0;b<a;b++){switch(c[b].nodeType){case 1:d+=SortableTable.getInnerText(c[b]);break;case 3:d+=c[b].nodeValue;break;}}return d;};SortableTable.prototype.getValueFromString=function(a,b){if(this._sortTypeInfo[b]){return this._sortTypeInfo[b].getValueFromString(a);}return a;};SortableTable.prototype.getSortFunction=function(b,a){if(this._sortTypeInfo[b]){return this._sortTypeInfo[b].compare;}return SortableTable.basicCompare;};SortableTable.prototype.destroy=function(){this.uninitHeader();var a=this.document.parentWindow;if(a&&typeof a.detachEvent!="undefined"){a.detachEvent("onunload",this._onunload);}this._onunload=null;this.element=null;this.tHead=null;this.tBody=null;this.document=null;this._headerOnclick=null;this.sortTypes=null;this._asyncsort=null;this.onsort=null;};SortableTable.prototype.addSortType=function(d,a,c,b){this._sortTypeInfo[d]={type:d,getValueFromString:a||SortableTable.idFunction,compare:c||SortableTable.basicCompare,getRowValue:b};};SortableTable.prototype.removeSortType=function(a){delete this._sortTypeInfo[a];};SortableTable.basicCompare=function compare(b,a){if(b.value<a.value){return -1;}if(a.value<b.value){return 1;}return 0;};SortableTable.idFunction=function(a){return a;};SortableTable.toUpperCase=function(a){return a.toUpperCase();};SortableTable.toDate=function(a){var b=a.split("-");var c=new Date(0);c.setFullYear(b[0]);c.setDate(b[2]);c.setMonth(b[1]-1);return c.valueOf();};SortableTable.toTransitionSize=function(c){var a=c.match(/(\d+(\.\d+)?)([a-z]+)/i);var d=a[3];var b=Number(a[1]);switch(d){case"GB":c=b*1073741824;break;case"MB":c=b*1048576;break;case"KB":c=b*1024;break;default:c=b;break;}return c;};SortableTable.toNumber=function(a){a="-"==a?-1:a;return Number(a);};SortableTable.prototype.addSortType("number",SortableTable.toNumber);SortableTable.prototype.addSortType("nocase",SortableTable.toUpperCase);SortableTable.prototype.addSortType("string");SortableTable.prototype.addSortType("size",SortableTable.toTransitionSize);