function checkAll(d){var b=document.getElementsByName("em_data");var e=b.length;for(var c=0;c<e;c++){b[c].checked=d;}file_size();}function download(c,d){var b=document.getElementsByName("em_data");var e=b.length;for(var c=c;c<e;c++){if(b[c].checked){window.location=b[c].value;if(d){timeout=6000;}else{timeout=500;}c++;download.delay(timeout,this,[c,0]);break;}}}function copy(){var c=document.getElementsByName("em_data");var e=c.length;var b="";for(var d=0;d<e;d++){if(c[d].checked){b+=c[d].value;b+="\r\n";}}copyToClipboard(b);}function copyToClipboard(b){if(window.clipboardData){window.clipboardData.clearData();window.clipboardData.setData("Text",b);}else{if(navigator.userAgent.indexOf("Opera")!=-1){window.location=b;}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");}catch(g){Window.alert("浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'");return false;}var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d){return;}var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c){return;}c.addDataFlavor("text/unicode");var h=new Object();var a=new Object();var h=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var i=b;h.data=i;c.setTransferData("text/unicode",h,i.length*2);var f=Components.interfaces.nsIClipboard;if(!d){return false;}d.setData(c,null,f.kGlobalClipboard);}}}}function file_size(){var b=document.getElementsByName("em_data");var j=b.length;try{var g=$("checkall_em_data");var f=0;g.checked=true;for(var d=0;d<j;d++){if(b[d].checked){var c=b[d].value.split("|");f+=c[3]*1;}else{g.checked=false;}}$("size_em_data").set("text",gen_size(f,3,1));}catch(h){Window.alert(h.message);}}function gen_size(c,a,b){sep=Math.pow(10,b);a=Math.pow(10,a);retval=c;unit="Bytes";if(c>=a*1000000000){c=Math.round(c/(1099511627776/sep))/sep;unit="TB";}else{if(c>=a*1000000){c=Math.round(c/(1073741824/sep))/sep;unit="GB";}else{if(c>=a*1000){c=Math.round(c/(1048576/sep))/sep;unit="MB";}else{if(c>=a){c=Math.round(c/(1024/sep))/sep;unit="KB";}}}}return c+unit;}